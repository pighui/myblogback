---
title: 美国人员数据分析案例
comments: true
tags:
  - Python
  - 数据分析
categories:
  - 数据分析
date: 2019-04-30 18:53:31
---


```python
import numpy as np
import pandas as pd
from pandas import Series, DataFrame
```

<!--more-->

1.首先导入文件，并查看数据样本

```python
popu = pd.read_csv('data/state-population.csv')
areas = pd.read_csv('data/state-areas.csv')
abbr = pd.read_csv('data/state-abbrevs.csv')
```

```python
popu.head()  # 查看前5行数据
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
    vertical-align: top;
}
.dataframe thead th {
    text-align: right;
}
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state/region</th>
      <th>ages</th>
      <th>year</th>
      <th>population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AL</td>
      <td>under18</td>
      <td>2012</td>
      <td>1117489.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AL</td>
      <td>total</td>
      <td>2012</td>
      <td>4817528.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AL</td>
      <td>under18</td>
      <td>2010</td>
      <td>1130966.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AL</td>
      <td>total</td>
      <td>2010</td>
      <td>4785570.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AL</td>
      <td>under18</td>
      <td>2011</td>
      <td>1125763.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
areas.tail() # 查看后5行数据
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
    vertical-align: top;
}
.dataframe thead th {
    text-align: right;
}
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>area (sq. mi)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>47</th>
      <td>West Virginia</td>
      <td>24231</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Wisconsin</td>
      <td>65503</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Wyoming</td>
      <td>97818</td>
    </tr>
    <tr>
      <th>50</th>
      <td>District of Columbia</td>
      <td>68</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Puerto Rico</td>
      <td>3515</td>
    </tr>
  </tbody>
</table>
</div>



```python
abbr.head()
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
    vertical-align: top;
}
.dataframe thead th {
    text-align: right;
}
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>abbreviation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alabama</td>
      <td>AL</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Alaska</td>
      <td>AK</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Arizona</td>
      <td>AZ</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Arkansas</td>
      <td>AR</td>
    </tr>
    <tr>
      <th>4</th>
      <td>California</td>
      <td>CA</td>
    </tr>
  </tbody>
</table>
</div>




2.合并pop与abbrevs两个DataFrame，分别依据state/region列和abbreviation列来合并。
为了保留所有信息，使用外合并

```python
pop_abbr = pd.merge(popu, abbr, 
                    left_on='state/region', 
                    right_on='abbreviation',
                    how='outer')
pop_abbr.head()
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
    vertical-align: top;
}
.dataframe thead th {
    text-align: right;
}
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state/region</th>
      <th>ages</th>
      <th>year</th>
      <th>population</th>
      <th>state</th>
      <th>abbreviation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AL</td>
      <td>under18</td>
      <td>2012</td>
      <td>1117489.0</td>
      <td>Alabama</td>
      <td>AL</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AL</td>
      <td>total</td>
      <td>2012</td>
      <td>4817528.0</td>
      <td>Alabama</td>
      <td>AL</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AL</td>
      <td>under18</td>
      <td>2010</td>
      <td>1130966.0</td>
      <td>Alabama</td>
      <td>AL</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AL</td>
      <td>total</td>
      <td>2010</td>
      <td>4785570.0</td>
      <td>Alabama</td>
      <td>AL</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AL</td>
      <td>under18</td>
      <td>2011</td>
      <td>1125763.0</td>
      <td>Alabama</td>
      <td>AL</td>
    </tr>
  </tbody>
</table>
</div>




3.去除abbreviation的那一列（axis=1）

```python
pop_abbr.drop('abbreviation', axis=1, inplace=True)
pop_abbr.head(2)
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
    vertical-align: top;
}
.dataframe thead th {
    text-align: right;
}
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state/region</th>
      <th>ages</th>
      <th>year</th>
      <th>population</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AL</td>
      <td>under18</td>
      <td>2012</td>
      <td>1117489.0</td>
      <td>Alabama</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AL</td>
      <td>total</td>
      <td>2012</td>
      <td>4817528.0</td>
      <td>Alabama</td>
    </tr>
  </tbody>
</table>
</div>




4.查看存在缺失数据的列。使用.isnull().any()，只有某一列存在一个缺失数据，就会显示True。

```python
pop_abbr.isnull().any(axis=0)
```



```
state/region    False
ages            False
year            False
population       True
state            True
dtype: bool
```



5.查看缺失数据的例子

```python
pop_abbr.loc[pop_abbr.isnull().any(axis=1)]
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
    vertical-align: top;
}
.dataframe thead th {
    text-align: right;
}
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state/region</th>
      <th>ages</th>
      <th>year</th>
      <th>population</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2448</th>
      <td>PR</td>
      <td>under18</td>
      <td>1990</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2449</th>
      <td>PR</td>
      <td>total</td>
      <td>1990</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2450</th>
      <td>PR</td>
      <td>total</td>
      <td>1991</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2451</th>
      <td>PR</td>
      <td>under18</td>
      <td>1991</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2452</th>
      <td>PR</td>
      <td>total</td>
      <td>1993</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2453</th>
      <td>PR</td>
      <td>under18</td>
      <td>1993</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2454</th>
      <td>PR</td>
      <td>under18</td>
      <td>1992</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2455</th>
      <td>PR</td>
      <td>total</td>
      <td>1992</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2456</th>
      <td>PR</td>
      <td>under18</td>
      <td>1994</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2457</th>
      <td>PR</td>
      <td>total</td>
      <td>1994</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2458</th>
      <td>PR</td>
      <td>total</td>
      <td>1995</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2459</th>
      <td>PR</td>
      <td>under18</td>
      <td>1995</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2460</th>
      <td>PR</td>
      <td>under18</td>
      <td>1996</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2461</th>
      <td>PR</td>
      <td>total</td>
      <td>1996</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2462</th>
      <td>PR</td>
      <td>under18</td>
      <td>1998</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2463</th>
      <td>PR</td>
      <td>total</td>
      <td>1998</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2464</th>
      <td>PR</td>
      <td>total</td>
      <td>1997</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2465</th>
      <td>PR</td>
      <td>under18</td>
      <td>1997</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2466</th>
      <td>PR</td>
      <td>total</td>
      <td>1999</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2467</th>
      <td>PR</td>
      <td>under18</td>
      <td>1999</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2468</th>
      <td>PR</td>
      <td>total</td>
      <td>2000</td>
      <td>3810605.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2469</th>
      <td>PR</td>
      <td>under18</td>
      <td>2000</td>
      <td>1089063.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2470</th>
      <td>PR</td>
      <td>total</td>
      <td>2001</td>
      <td>3818774.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2471</th>
      <td>PR</td>
      <td>under18</td>
      <td>2001</td>
      <td>1077566.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2472</th>
      <td>PR</td>
      <td>total</td>
      <td>2002</td>
      <td>3823701.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2473</th>
      <td>PR</td>
      <td>under18</td>
      <td>2002</td>
      <td>1065051.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2474</th>
      <td>PR</td>
      <td>total</td>
      <td>2004</td>
      <td>3826878.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2475</th>
      <td>PR</td>
      <td>under18</td>
      <td>2004</td>
      <td>1035919.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2476</th>
      <td>PR</td>
      <td>total</td>
      <td>2003</td>
      <td>3826095.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2477</th>
      <td>PR</td>
      <td>under18</td>
      <td>2003</td>
      <td>1050615.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2514</th>
      <td>USA</td>
      <td>under18</td>
      <td>1999</td>
      <td>71946051.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2515</th>
      <td>USA</td>
      <td>total</td>
      <td>2000</td>
      <td>282162411.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2516</th>
      <td>USA</td>
      <td>under18</td>
      <td>2000</td>
      <td>72376189.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2517</th>
      <td>USA</td>
      <td>total</td>
      <td>1999</td>
      <td>279040181.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2518</th>
      <td>USA</td>
      <td>total</td>
      <td>2001</td>
      <td>284968955.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2519</th>
      <td>USA</td>
      <td>under18</td>
      <td>2001</td>
      <td>72671175.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2520</th>
      <td>USA</td>
      <td>total</td>
      <td>2002</td>
      <td>287625193.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2521</th>
      <td>USA</td>
      <td>under18</td>
      <td>2002</td>
      <td>72936457.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2522</th>
      <td>USA</td>
      <td>total</td>
      <td>2003</td>
      <td>290107933.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2523</th>
      <td>USA</td>
      <td>under18</td>
      <td>2003</td>
      <td>73100758.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2524</th>
      <td>USA</td>
      <td>total</td>
      <td>2004</td>
      <td>292805298.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2525</th>
      <td>USA</td>
      <td>under18</td>
      <td>2004</td>
      <td>73297735.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2526</th>
      <td>USA</td>
      <td>total</td>
      <td>2005</td>
      <td>295516599.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2527</th>
      <td>USA</td>
      <td>under18</td>
      <td>2005</td>
      <td>73523669.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2528</th>
      <td>USA</td>
      <td>total</td>
      <td>2006</td>
      <td>298379912.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2529</th>
      <td>USA</td>
      <td>under18</td>
      <td>2006</td>
      <td>73757714.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2530</th>
      <td>USA</td>
      <td>total</td>
      <td>2007</td>
      <td>301231207.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2531</th>
      <td>USA</td>
      <td>under18</td>
      <td>2007</td>
      <td>74019405.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2532</th>
      <td>USA</td>
      <td>total</td>
      <td>2008</td>
      <td>304093966.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2533</th>
      <td>USA</td>
      <td>under18</td>
      <td>2008</td>
      <td>74104602.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2534</th>
      <td>USA</td>
      <td>under18</td>
      <td>2013</td>
      <td>73585872.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2535</th>
      <td>USA</td>
      <td>total</td>
      <td>2013</td>
      <td>316128839.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2536</th>
      <td>USA</td>
      <td>total</td>
      <td>2009</td>
      <td>306771529.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2537</th>
      <td>USA</td>
      <td>under18</td>
      <td>2009</td>
      <td>74134167.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2538</th>
      <td>USA</td>
      <td>under18</td>
      <td>2010</td>
      <td>74119556.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2539</th>
      <td>USA</td>
      <td>total</td>
      <td>2010</td>
      <td>309326295.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2540</th>
      <td>USA</td>
      <td>under18</td>
      <td>2011</td>
      <td>73902222.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2541</th>
      <td>USA</td>
      <td>total</td>
      <td>2011</td>
      <td>311582564.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2542</th>
      <td>USA</td>
      <td>under18</td>
      <td>2012</td>
      <td>73708179.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2543</th>
      <td>USA</td>
      <td>total</td>
      <td>2012</td>
      <td>313873685.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>96 rows × 5 columns</p>
</div>



6.找到有哪些state/region使得state的值为NaN，使用unique()去重

```python
pop_abbr.loc[pop_abbr.isnull().any(axis=1)]['state/region'].unique()
```



```
array(['PR', 'USA'], dtype=object)
```



```python
map = {
    'PR': 'PUERTO RICO',
    'USA': 'UnitedStates America'
}
```

7.为找到的这些state/region的state项补上正确的值，从而去除掉state这一列的所有NaN！记住这样清除缺失数据NaN的方法！

```python
pop_abbr.loc[pop_abbr['state/region']=='PR','state'] = 'PUERTO RICO'
pop_abbr[pop_abbr['state/region']=='PR']
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
    vertical-align: top;
}
.dataframe thead th {
    text-align: right;
}
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state/region</th>
      <th>ages</th>
      <th>year</th>
      <th>population</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2448</th>
      <td>PR</td>
      <td>under18</td>
      <td>1990</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2449</th>
      <td>PR</td>
      <td>total</td>
      <td>1990</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2450</th>
      <td>PR</td>
      <td>total</td>
      <td>1991</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2451</th>
      <td>PR</td>
      <td>under18</td>
      <td>1991</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2452</th>
      <td>PR</td>
      <td>total</td>
      <td>1993</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2453</th>
      <td>PR</td>
      <td>under18</td>
      <td>1993</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2454</th>
      <td>PR</td>
      <td>under18</td>
      <td>1992</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2455</th>
      <td>PR</td>
      <td>total</td>
      <td>1992</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2456</th>
      <td>PR</td>
      <td>under18</td>
      <td>1994</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2457</th>
      <td>PR</td>
      <td>total</td>
      <td>1994</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2458</th>
      <td>PR</td>
      <td>total</td>
      <td>1995</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2459</th>
      <td>PR</td>
      <td>under18</td>
      <td>1995</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2460</th>
      <td>PR</td>
      <td>under18</td>
      <td>1996</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2461</th>
      <td>PR</td>
      <td>total</td>
      <td>1996</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2462</th>
      <td>PR</td>
      <td>under18</td>
      <td>1998</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2463</th>
      <td>PR</td>
      <td>total</td>
      <td>1998</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2464</th>
      <td>PR</td>
      <td>total</td>
      <td>1997</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2465</th>
      <td>PR</td>
      <td>under18</td>
      <td>1997</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2466</th>
      <td>PR</td>
      <td>total</td>
      <td>1999</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2467</th>
      <td>PR</td>
      <td>under18</td>
      <td>1999</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2468</th>
      <td>PR</td>
      <td>total</td>
      <td>2000</td>
      <td>3810605.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2469</th>
      <td>PR</td>
      <td>under18</td>
      <td>2000</td>
      <td>1089063.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2470</th>
      <td>PR</td>
      <td>total</td>
      <td>2001</td>
      <td>3818774.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2471</th>
      <td>PR</td>
      <td>under18</td>
      <td>2001</td>
      <td>1077566.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2472</th>
      <td>PR</td>
      <td>total</td>
      <td>2002</td>
      <td>3823701.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2473</th>
      <td>PR</td>
      <td>under18</td>
      <td>2002</td>
      <td>1065051.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2474</th>
      <td>PR</td>
      <td>total</td>
      <td>2004</td>
      <td>3826878.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2475</th>
      <td>PR</td>
      <td>under18</td>
      <td>2004</td>
      <td>1035919.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2476</th>
      <td>PR</td>
      <td>total</td>
      <td>2003</td>
      <td>3826095.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2477</th>
      <td>PR</td>
      <td>under18</td>
      <td>2003</td>
      <td>1050615.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2478</th>
      <td>PR</td>
      <td>total</td>
      <td>2005</td>
      <td>3821362.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2479</th>
      <td>PR</td>
      <td>under18</td>
      <td>2005</td>
      <td>1019447.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2480</th>
      <td>PR</td>
      <td>total</td>
      <td>2006</td>
      <td>3805214.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2481</th>
      <td>PR</td>
      <td>under18</td>
      <td>2006</td>
      <td>998543.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2482</th>
      <td>PR</td>
      <td>total</td>
      <td>2007</td>
      <td>3782995.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2483</th>
      <td>PR</td>
      <td>under18</td>
      <td>2007</td>
      <td>973613.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2484</th>
      <td>PR</td>
      <td>total</td>
      <td>2008</td>
      <td>3760866.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2485</th>
      <td>PR</td>
      <td>under18</td>
      <td>2008</td>
      <td>945705.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2486</th>
      <td>PR</td>
      <td>under18</td>
      <td>2013</td>
      <td>814068.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2487</th>
      <td>PR</td>
      <td>total</td>
      <td>2013</td>
      <td>3615086.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2488</th>
      <td>PR</td>
      <td>total</td>
      <td>2009</td>
      <td>3740410.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2489</th>
      <td>PR</td>
      <td>under18</td>
      <td>2009</td>
      <td>920794.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2490</th>
      <td>PR</td>
      <td>total</td>
      <td>2010</td>
      <td>3721208.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2491</th>
      <td>PR</td>
      <td>under18</td>
      <td>2010</td>
      <td>896945.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2492</th>
      <td>PR</td>
      <td>under18</td>
      <td>2011</td>
      <td>869327.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2493</th>
      <td>PR</td>
      <td>total</td>
      <td>2011</td>
      <td>3686580.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2494</th>
      <td>PR</td>
      <td>under18</td>
      <td>2012</td>
      <td>841740.0</td>
      <td>PUERTO RICO</td>
    </tr>
    <tr>
      <th>2495</th>
      <td>PR</td>
      <td>total</td>
      <td>2012</td>
      <td>3651545.0</td>
      <td>PUERTO RICO</td>
    </tr>
  </tbody>
</table>
</div>




```python
pop_abbr.loc[pop_abbr['state/region']=='USA','state'] = 'UnitedStates America'
pop_abbr.loc[pop_abbr['state/region']=='USA']
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
    vertical-align: top;
}
.dataframe thead th {
    text-align: right;
}
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state/region</th>
      <th>ages</th>
      <th>year</th>
      <th>population</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2496</th>
      <td>USA</td>
      <td>under18</td>
      <td>1990</td>
      <td>64218512.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2497</th>
      <td>USA</td>
      <td>total</td>
      <td>1990</td>
      <td>249622814.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2498</th>
      <td>USA</td>
      <td>total</td>
      <td>1991</td>
      <td>252980942.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2499</th>
      <td>USA</td>
      <td>under18</td>
      <td>1991</td>
      <td>65313018.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2500</th>
      <td>USA</td>
      <td>under18</td>
      <td>1992</td>
      <td>66509177.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2501</th>
      <td>USA</td>
      <td>total</td>
      <td>1992</td>
      <td>256514231.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2502</th>
      <td>USA</td>
      <td>total</td>
      <td>1993</td>
      <td>259918595.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2503</th>
      <td>USA</td>
      <td>under18</td>
      <td>1993</td>
      <td>67594938.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2504</th>
      <td>USA</td>
      <td>under18</td>
      <td>1994</td>
      <td>68640936.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2505</th>
      <td>USA</td>
      <td>total</td>
      <td>1994</td>
      <td>263125826.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2506</th>
      <td>USA</td>
      <td>under18</td>
      <td>1995</td>
      <td>69473140.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2507</th>
      <td>USA</td>
      <td>under18</td>
      <td>1996</td>
      <td>70233512.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2508</th>
      <td>USA</td>
      <td>total</td>
      <td>1995</td>
      <td>266278403.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2509</th>
      <td>USA</td>
      <td>total</td>
      <td>1996</td>
      <td>269394291.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2510</th>
      <td>USA</td>
      <td>total</td>
      <td>1997</td>
      <td>272646932.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2511</th>
      <td>USA</td>
      <td>under18</td>
      <td>1997</td>
      <td>70920738.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2512</th>
      <td>USA</td>
      <td>under18</td>
      <td>1998</td>
      <td>71431406.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2513</th>
      <td>USA</td>
      <td>total</td>
      <td>1998</td>
      <td>275854116.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2514</th>
      <td>USA</td>
      <td>under18</td>
      <td>1999</td>
      <td>71946051.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2515</th>
      <td>USA</td>
      <td>total</td>
      <td>2000</td>
      <td>282162411.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2516</th>
      <td>USA</td>
      <td>under18</td>
      <td>2000</td>
      <td>72376189.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2517</th>
      <td>USA</td>
      <td>total</td>
      <td>1999</td>
      <td>279040181.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2518</th>
      <td>USA</td>
      <td>total</td>
      <td>2001</td>
      <td>284968955.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2519</th>
      <td>USA</td>
      <td>under18</td>
      <td>2001</td>
      <td>72671175.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2520</th>
      <td>USA</td>
      <td>total</td>
      <td>2002</td>
      <td>287625193.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2521</th>
      <td>USA</td>
      <td>under18</td>
      <td>2002</td>
      <td>72936457.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2522</th>
      <td>USA</td>
      <td>total</td>
      <td>2003</td>
      <td>290107933.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2523</th>
      <td>USA</td>
      <td>under18</td>
      <td>2003</td>
      <td>73100758.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2524</th>
      <td>USA</td>
      <td>total</td>
      <td>2004</td>
      <td>292805298.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2525</th>
      <td>USA</td>
      <td>under18</td>
      <td>2004</td>
      <td>73297735.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2526</th>
      <td>USA</td>
      <td>total</td>
      <td>2005</td>
      <td>295516599.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2527</th>
      <td>USA</td>
      <td>under18</td>
      <td>2005</td>
      <td>73523669.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2528</th>
      <td>USA</td>
      <td>total</td>
      <td>2006</td>
      <td>298379912.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2529</th>
      <td>USA</td>
      <td>under18</td>
      <td>2006</td>
      <td>73757714.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2530</th>
      <td>USA</td>
      <td>total</td>
      <td>2007</td>
      <td>301231207.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2531</th>
      <td>USA</td>
      <td>under18</td>
      <td>2007</td>
      <td>74019405.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2532</th>
      <td>USA</td>
      <td>total</td>
      <td>2008</td>
      <td>304093966.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2533</th>
      <td>USA</td>
      <td>under18</td>
      <td>2008</td>
      <td>74104602.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2534</th>
      <td>USA</td>
      <td>under18</td>
      <td>2013</td>
      <td>73585872.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2535</th>
      <td>USA</td>
      <td>total</td>
      <td>2013</td>
      <td>316128839.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2536</th>
      <td>USA</td>
      <td>total</td>
      <td>2009</td>
      <td>306771529.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2537</th>
      <td>USA</td>
      <td>under18</td>
      <td>2009</td>
      <td>74134167.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2538</th>
      <td>USA</td>
      <td>under18</td>
      <td>2010</td>
      <td>74119556.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2539</th>
      <td>USA</td>
      <td>total</td>
      <td>2010</td>
      <td>309326295.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2540</th>
      <td>USA</td>
      <td>under18</td>
      <td>2011</td>
      <td>73902222.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2541</th>
      <td>USA</td>
      <td>total</td>
      <td>2011</td>
      <td>311582564.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2542</th>
      <td>USA</td>
      <td>under18</td>
      <td>2012</td>
      <td>73708179.0</td>
      <td>UnitedStates America</td>
    </tr>
    <tr>
      <th>2543</th>
      <td>USA</td>
      <td>total</td>
      <td>2012</td>
      <td>313873685.0</td>
      <td>UnitedStates America</td>
    </tr>
  </tbody>
</table>
</div>




8.合并各州面积数据areas，使用左合并。

```python
pop_abbr.head(2)
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
    vertical-align: top;
}
.dataframe thead th {
    text-align: right;
}
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state/region</th>
      <th>ages</th>
      <th>year</th>
      <th>population</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AL</td>
      <td>under18</td>
      <td>2012</td>
      <td>1117489.0</td>
      <td>Alabama</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AL</td>
      <td>total</td>
      <td>2012</td>
      <td>4817528.0</td>
      <td>Alabama</td>
    </tr>
  </tbody>
</table>
</div>




```python
areas.head(2)
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
    vertical-align: top;
}
.dataframe thead th {
    text-align: right;
}
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>area (sq. mi)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alabama</td>
      <td>52423</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Alaska</td>
      <td>656425</td>
    </tr>
  </tbody>
</table>
</div>




```python
pop_abbr_areas = pd.merge(pop_abbr, areas, how='left')
pop_abbr_areas.head()
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
    vertical-align: top;
}
.dataframe thead th {
    text-align: right;
}
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state/region</th>
      <th>ages</th>
      <th>year</th>
      <th>population</th>
      <th>state</th>
      <th>area (sq. mi)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AL</td>
      <td>under18</td>
      <td>2012</td>
      <td>1117489.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AL</td>
      <td>total</td>
      <td>2012</td>
      <td>4817528.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AL</td>
      <td>under18</td>
      <td>2010</td>
      <td>1130966.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AL</td>
      <td>total</td>
      <td>2010</td>
      <td>4785570.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AL</td>
      <td>under18</td>
      <td>2011</td>
      <td>1125763.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
  </tbody>
</table>
</div>




9.继续寻找存在缺失数据的列

```python
pop_abbr_areas.isnull().any(axis=0)
```



```
state/region     False
ages             False
year             False
population        True
state            False
area (sq. mi)     True
dtype: bool
```



10.我们会发现area(sq.mi)这一列有缺失数据，为了找出是哪一行，我们需要找出是哪个state没有数据

```python
pop_abbr_areas[pop_abbr_areas.isnull().any(axis=1)]
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
    vertical-align: top;
}
.dataframe thead th {
    text-align: right;
}
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state/region</th>
      <th>ages</th>
      <th>year</th>
      <th>population</th>
      <th>state</th>
      <th>area (sq. mi)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2448</th>
      <td>PR</td>
      <td>under18</td>
      <td>1990</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2449</th>
      <td>PR</td>
      <td>total</td>
      <td>1990</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2450</th>
      <td>PR</td>
      <td>total</td>
      <td>1991</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2451</th>
      <td>PR</td>
      <td>under18</td>
      <td>1991</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2452</th>
      <td>PR</td>
      <td>total</td>
      <td>1993</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2453</th>
      <td>PR</td>
      <td>under18</td>
      <td>1993</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2454</th>
      <td>PR</td>
      <td>under18</td>
      <td>1992</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2455</th>
      <td>PR</td>
      <td>total</td>
      <td>1992</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2456</th>
      <td>PR</td>
      <td>under18</td>
      <td>1994</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2457</th>
      <td>PR</td>
      <td>total</td>
      <td>1994</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2458</th>
      <td>PR</td>
      <td>total</td>
      <td>1995</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2459</th>
      <td>PR</td>
      <td>under18</td>
      <td>1995</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2460</th>
      <td>PR</td>
      <td>under18</td>
      <td>1996</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2461</th>
      <td>PR</td>
      <td>total</td>
      <td>1996</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2462</th>
      <td>PR</td>
      <td>under18</td>
      <td>1998</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2463</th>
      <td>PR</td>
      <td>total</td>
      <td>1998</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2464</th>
      <td>PR</td>
      <td>total</td>
      <td>1997</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2465</th>
      <td>PR</td>
      <td>under18</td>
      <td>1997</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2466</th>
      <td>PR</td>
      <td>total</td>
      <td>1999</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2467</th>
      <td>PR</td>
      <td>under18</td>
      <td>1999</td>
      <td>NaN</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2468</th>
      <td>PR</td>
      <td>total</td>
      <td>2000</td>
      <td>3810605.0</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2469</th>
      <td>PR</td>
      <td>under18</td>
      <td>2000</td>
      <td>1089063.0</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2470</th>
      <td>PR</td>
      <td>total</td>
      <td>2001</td>
      <td>3818774.0</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2471</th>
      <td>PR</td>
      <td>under18</td>
      <td>2001</td>
      <td>1077566.0</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2472</th>
      <td>PR</td>
      <td>total</td>
      <td>2002</td>
      <td>3823701.0</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2473</th>
      <td>PR</td>
      <td>under18</td>
      <td>2002</td>
      <td>1065051.0</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2474</th>
      <td>PR</td>
      <td>total</td>
      <td>2004</td>
      <td>3826878.0</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2475</th>
      <td>PR</td>
      <td>under18</td>
      <td>2004</td>
      <td>1035919.0</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2476</th>
      <td>PR</td>
      <td>total</td>
      <td>2003</td>
      <td>3826095.0</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2477</th>
      <td>PR</td>
      <td>under18</td>
      <td>2003</td>
      <td>1050615.0</td>
      <td>PUERTO RICO</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2514</th>
      <td>USA</td>
      <td>under18</td>
      <td>1999</td>
      <td>71946051.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2515</th>
      <td>USA</td>
      <td>total</td>
      <td>2000</td>
      <td>282162411.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2516</th>
      <td>USA</td>
      <td>under18</td>
      <td>2000</td>
      <td>72376189.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2517</th>
      <td>USA</td>
      <td>total</td>
      <td>1999</td>
      <td>279040181.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2518</th>
      <td>USA</td>
      <td>total</td>
      <td>2001</td>
      <td>284968955.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2519</th>
      <td>USA</td>
      <td>under18</td>
      <td>2001</td>
      <td>72671175.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2520</th>
      <td>USA</td>
      <td>total</td>
      <td>2002</td>
      <td>287625193.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2521</th>
      <td>USA</td>
      <td>under18</td>
      <td>2002</td>
      <td>72936457.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2522</th>
      <td>USA</td>
      <td>total</td>
      <td>2003</td>
      <td>290107933.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2523</th>
      <td>USA</td>
      <td>under18</td>
      <td>2003</td>
      <td>73100758.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2524</th>
      <td>USA</td>
      <td>total</td>
      <td>2004</td>
      <td>292805298.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2525</th>
      <td>USA</td>
      <td>under18</td>
      <td>2004</td>
      <td>73297735.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2526</th>
      <td>USA</td>
      <td>total</td>
      <td>2005</td>
      <td>295516599.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2527</th>
      <td>USA</td>
      <td>under18</td>
      <td>2005</td>
      <td>73523669.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2528</th>
      <td>USA</td>
      <td>total</td>
      <td>2006</td>
      <td>298379912.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2529</th>
      <td>USA</td>
      <td>under18</td>
      <td>2006</td>
      <td>73757714.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2530</th>
      <td>USA</td>
      <td>total</td>
      <td>2007</td>
      <td>301231207.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2531</th>
      <td>USA</td>
      <td>under18</td>
      <td>2007</td>
      <td>74019405.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2532</th>
      <td>USA</td>
      <td>total</td>
      <td>2008</td>
      <td>304093966.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2533</th>
      <td>USA</td>
      <td>under18</td>
      <td>2008</td>
      <td>74104602.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2534</th>
      <td>USA</td>
      <td>under18</td>
      <td>2013</td>
      <td>73585872.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2535</th>
      <td>USA</td>
      <td>total</td>
      <td>2013</td>
      <td>316128839.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2536</th>
      <td>USA</td>
      <td>total</td>
      <td>2009</td>
      <td>306771529.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2537</th>
      <td>USA</td>
      <td>under18</td>
      <td>2009</td>
      <td>74134167.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2538</th>
      <td>USA</td>
      <td>under18</td>
      <td>2010</td>
      <td>74119556.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2539</th>
      <td>USA</td>
      <td>total</td>
      <td>2010</td>
      <td>309326295.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2540</th>
      <td>USA</td>
      <td>under18</td>
      <td>2011</td>
      <td>73902222.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2541</th>
      <td>USA</td>
      <td>total</td>
      <td>2011</td>
      <td>311582564.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2542</th>
      <td>USA</td>
      <td>under18</td>
      <td>2012</td>
      <td>73708179.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2543</th>
      <td>USA</td>
      <td>total</td>
      <td>2012</td>
      <td>313873685.0</td>
      <td>UnitedStates America</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>96 rows × 6 columns</p>
</div>



11.去除含有缺失数据的行

```python
# 获取为Nan值的行索引
drop_index = pop_abbr_areas[pop_abbr_areas.isnull().any(axis=1)].index
drop_index
```



```
Int64Index([2448, 2449, 2450, 2451, 2452, 2453, 2454, 2455, 2456, 2457, 2458,
            2459, 2460, 2461, 2462, 2463, 2464, 2465, 2466, 2467, 2468, 2469,
            2470, 2471, 2472, 2473, 2474, 2475, 2476, 2477, 2478, 2479, 2480,
            2481, 2482, 2483, 2484, 2485, 2486, 2487, 2488, 2489, 2490, 2491,
            2492, 2493, 2494, 2495, 2496, 2497, 2498, 2499, 2500, 2501, 2502,
            2503, 2504, 2505, 2506, 2507, 2508, 2509, 2510, 2511, 2512, 2513,
            2514, 2515, 2516, 2517, 2518, 2519, 2520, 2521, 2522, 2523, 2524,
            2525, 2526, 2527, 2528, 2529, 2530, 2531, 2532, 2533, 2534, 2535,
            2536, 2537, 2538, 2539, 2540, 2541, 2542, 2543],
           dtype='int64')
```



```python
# 根据行索引再删除
pop_abbr_areas.drop(drop_index, inplace=True)
pop_abbr_areas[pop_abbr_areas.isnull().any(axis=1)].head()
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
    vertical-align: top;
}
.dataframe thead th {
    text-align: right;
}
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state/region</th>
      <th>ages</th>
      <th>year</th>
      <th>population</th>
      <th>state</th>
      <th>area (sq. mi)</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>




```python
pop_abbr_areas.isnull().any(axis=1).unique()
```



```
array([False])
```



12找出2010年的全民人口数据

```python
pop_abbr_areas.head()
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
    vertical-align: top;
}
.dataframe thead th {
    text-align: right;
}
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state/region</th>
      <th>ages</th>
      <th>year</th>
      <th>population</th>
      <th>state</th>
      <th>area (sq. mi)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AL</td>
      <td>under18</td>
      <td>2012</td>
      <td>1117489.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AL</td>
      <td>total</td>
      <td>2012</td>
      <td>4817528.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AL</td>
      <td>under18</td>
      <td>2010</td>
      <td>1130966.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AL</td>
      <td>total</td>
      <td>2010</td>
      <td>4785570.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AL</td>
      <td>under18</td>
      <td>2011</td>
      <td>1125763.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
pop_abbr_areas.query('ages=="total" & year=="2010"')['population'].sum()
```



```
309326295.0
```



13.对查询结果进行处理，以state列作为新的行索引

```python
pop_abbr_areas.head()
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
    vertical-align: top;
}
.dataframe thead th {
    text-align: right;
}
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state/region</th>
      <th>ages</th>
      <th>year</th>
      <th>population</th>
      <th>state</th>
      <th>area (sq. mi)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AL</td>
      <td>under18</td>
      <td>2012</td>
      <td>1117489.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AL</td>
      <td>total</td>
      <td>2012</td>
      <td>4817528.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AL</td>
      <td>under18</td>
      <td>2010</td>
      <td>1130966.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AL</td>
      <td>total</td>
      <td>2010</td>
      <td>4785570.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AL</td>
      <td>under18</td>
      <td>2011</td>
      <td>1125763.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
pp = pop_abbr_areas.set_index('state') # 将某一列设置为行索引标签（列值）
pp
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
    vertical-align: top;
}
.dataframe thead th {
    text-align: right;
}
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state/region</th>
      <th>ages</th>
      <th>year</th>
      <th>population</th>
      <th>area (sq. mi)</th>
    </tr>
    <tr>
      <th>state</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>under18</td>
      <td>2012</td>
      <td>1117489.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>total</td>
      <td>2012</td>
      <td>4817528.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>under18</td>
      <td>2010</td>
      <td>1130966.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>total</td>
      <td>2010</td>
      <td>4785570.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>under18</td>
      <td>2011</td>
      <td>1125763.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>total</td>
      <td>2011</td>
      <td>4801627.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>total</td>
      <td>2009</td>
      <td>4757938.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>under18</td>
      <td>2009</td>
      <td>1134192.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>under18</td>
      <td>2013</td>
      <td>1111481.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>total</td>
      <td>2013</td>
      <td>4833722.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>total</td>
      <td>2007</td>
      <td>4672840.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>under18</td>
      <td>2007</td>
      <td>1132296.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>total</td>
      <td>2008</td>
      <td>4718206.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>under18</td>
      <td>2008</td>
      <td>1134927.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>total</td>
      <td>2005</td>
      <td>4569805.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>under18</td>
      <td>2005</td>
      <td>1117229.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>total</td>
      <td>2006</td>
      <td>4628981.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>under18</td>
      <td>2006</td>
      <td>1126798.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>total</td>
      <td>2004</td>
      <td>4530729.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>under18</td>
      <td>2004</td>
      <td>1113662.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>total</td>
      <td>2003</td>
      <td>4503491.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>under18</td>
      <td>2003</td>
      <td>1113083.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>total</td>
      <td>2001</td>
      <td>4467634.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>under18</td>
      <td>2001</td>
      <td>1120409.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>total</td>
      <td>2002</td>
      <td>4480089.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>under18</td>
      <td>2002</td>
      <td>1116590.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>under18</td>
      <td>1999</td>
      <td>1121287.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>total</td>
      <td>1999</td>
      <td>4430141.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>total</td>
      <td>2000</td>
      <td>4452173.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>under18</td>
      <td>2000</td>
      <td>1122273.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>total</td>
      <td>2003</td>
      <td>503453.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>under18</td>
      <td>2003</td>
      <td>124182.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>total</td>
      <td>2004</td>
      <td>509106.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>under18</td>
      <td>2004</td>
      <td>123974.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>total</td>
      <td>2002</td>
      <td>500017.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>under18</td>
      <td>2002</td>
      <td>125495.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>total</td>
      <td>2001</td>
      <td>494657.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>under18</td>
      <td>2001</td>
      <td>126212.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>total</td>
      <td>2000</td>
      <td>494300.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>under18</td>
      <td>2000</td>
      <td>128774.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>total</td>
      <td>1999</td>
      <td>491780.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>under18</td>
      <td>1999</td>
      <td>130793.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>total</td>
      <td>1997</td>
      <td>489452.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>under18</td>
      <td>1997</td>
      <td>134328.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>under18</td>
      <td>1998</td>
      <td>132602.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>total</td>
      <td>1998</td>
      <td>490787.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>under18</td>
      <td>1996</td>
      <td>135698.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>total</td>
      <td>1996</td>
      <td>488167.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>total</td>
      <td>1995</td>
      <td>485160.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>under18</td>
      <td>1995</td>
      <td>136785.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>under18</td>
      <td>1994</td>
      <td>137733.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>total</td>
      <td>1994</td>
      <td>480283.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>under18</td>
      <td>1992</td>
      <td>137308.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>total</td>
      <td>1992</td>
      <td>466251.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>total</td>
      <td>1993</td>
      <td>473081.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>under18</td>
      <td>1993</td>
      <td>137458.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>total</td>
      <td>1991</td>
      <td>459260.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>under18</td>
      <td>1991</td>
      <td>136720.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>under18</td>
      <td>1990</td>
      <td>136078.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <td>WY</td>
      <td>total</td>
      <td>1990</td>
      <td>453690.0</td>
      <td>97818.0</td>
    </tr>
  </tbody>
</table>
<p>2448 rows × 5 columns</p>
</div>



```python
pp.reset_index(drop=False) # 将行索引标签转成列， drop=True删除行索引标签
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
    vertical-align: top;
}
.dataframe thead th {
    text-align: right;
}
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>state/region</th>
      <th>ages</th>
      <th>year</th>
      <th>population</th>
      <th>area (sq. mi)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>under18</td>
      <td>2012</td>
      <td>1117489.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>total</td>
      <td>2012</td>
      <td>4817528.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>under18</td>
      <td>2010</td>
      <td>1130966.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>total</td>
      <td>2010</td>
      <td>4785570.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>under18</td>
      <td>2011</td>
      <td>1125763.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>total</td>
      <td>2011</td>
      <td>4801627.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>total</td>
      <td>2009</td>
      <td>4757938.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>under18</td>
      <td>2009</td>
      <td>1134192.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>under18</td>
      <td>2013</td>
      <td>1111481.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>total</td>
      <td>2013</td>
      <td>4833722.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>total</td>
      <td>2007</td>
      <td>4672840.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>under18</td>
      <td>2007</td>
      <td>1132296.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>total</td>
      <td>2008</td>
      <td>4718206.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>under18</td>
      <td>2008</td>
      <td>1134927.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>total</td>
      <td>2005</td>
      <td>4569805.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>under18</td>
      <td>2005</td>
      <td>1117229.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>total</td>
      <td>2006</td>
      <td>4628981.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>under18</td>
      <td>2006</td>
      <td>1126798.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>total</td>
      <td>2004</td>
      <td>4530729.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>under18</td>
      <td>2004</td>
      <td>1113662.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>total</td>
      <td>2003</td>
      <td>4503491.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>under18</td>
      <td>2003</td>
      <td>1113083.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>total</td>
      <td>2001</td>
      <td>4467634.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>under18</td>
      <td>2001</td>
      <td>1120409.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>total</td>
      <td>2002</td>
      <td>4480089.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>under18</td>
      <td>2002</td>
      <td>1116590.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>under18</td>
      <td>1999</td>
      <td>1121287.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>total</td>
      <td>1999</td>
      <td>4430141.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>total</td>
      <td>2000</td>
      <td>4452173.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Alabama</td>
      <td>AL</td>
      <td>under18</td>
      <td>2000</td>
      <td>1122273.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2418</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>total</td>
      <td>2003</td>
      <td>503453.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2419</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>under18</td>
      <td>2003</td>
      <td>124182.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2420</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>total</td>
      <td>2004</td>
      <td>509106.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2421</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>under18</td>
      <td>2004</td>
      <td>123974.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2422</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>total</td>
      <td>2002</td>
      <td>500017.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2423</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>under18</td>
      <td>2002</td>
      <td>125495.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2424</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>total</td>
      <td>2001</td>
      <td>494657.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2425</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>under18</td>
      <td>2001</td>
      <td>126212.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2426</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>total</td>
      <td>2000</td>
      <td>494300.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2427</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>under18</td>
      <td>2000</td>
      <td>128774.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2428</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>total</td>
      <td>1999</td>
      <td>491780.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2429</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>under18</td>
      <td>1999</td>
      <td>130793.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2430</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>total</td>
      <td>1997</td>
      <td>489452.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2431</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>under18</td>
      <td>1997</td>
      <td>134328.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2432</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>under18</td>
      <td>1998</td>
      <td>132602.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2433</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>total</td>
      <td>1998</td>
      <td>490787.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2434</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>under18</td>
      <td>1996</td>
      <td>135698.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2435</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>total</td>
      <td>1996</td>
      <td>488167.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2436</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>total</td>
      <td>1995</td>
      <td>485160.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2437</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>under18</td>
      <td>1995</td>
      <td>136785.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2438</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>under18</td>
      <td>1994</td>
      <td>137733.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2439</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>total</td>
      <td>1994</td>
      <td>480283.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2440</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>under18</td>
      <td>1992</td>
      <td>137308.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2441</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>total</td>
      <td>1992</td>
      <td>466251.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2442</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>total</td>
      <td>1993</td>
      <td>473081.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2443</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>under18</td>
      <td>1993</td>
      <td>137458.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2444</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>total</td>
      <td>1991</td>
      <td>459260.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2445</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>under18</td>
      <td>1991</td>
      <td>136720.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2446</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>under18</td>
      <td>1990</td>
      <td>136078.0</td>
      <td>97818.0</td>
    </tr>
    <tr>
      <th>2447</th>
      <td>Wyoming</td>
      <td>WY</td>
      <td>total</td>
      <td>1990</td>
      <td>453690.0</td>
      <td>97818.0</td>
    </tr>
  </tbody>
</table>
<p>2448 rows × 6 columns</p>
</div>



14.计算人口密度。注意是Series/Series，其结果还是一个Series

```python
pp.head()
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
    vertical-align: top;
}
.dataframe thead th {
    text-align: right;
}
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state/region</th>
      <th>ages</th>
      <th>year</th>
      <th>population</th>
      <th>area (sq. mi)</th>
    </tr>
    <tr>
      <th>state</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>under18</td>
      <td>2012</td>
      <td>1117489.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>total</td>
      <td>2012</td>
      <td>4817528.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>under18</td>
      <td>2010</td>
      <td>1130966.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>total</td>
      <td>2010</td>
      <td>4785570.0</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>Alabama</th>
      <td>AL</td>
      <td>under18</td>
      <td>2011</td>
      <td>1125763.0</td>
      <td>52423.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 查看2012年各州的人口密度
pp_2 = pp.query('ages=="total" & year=="2012"')
pp_2['population'].div(pp_2['area (sq. mi)'])
```



```
state
Alabama                   91.897221
Alaska                     1.112552
Arizona                   57.463195
Arkansas                  55.466662
California               232.121278
Colorado                  49.850701
Connecticut              647.865260
Delaware                 469.320880
District of Columbia    9315.102941
Florida                  293.815946
Georgia                  166.814926
Hawaii                   127.157885
Idaho                     19.091942
Illinois                 222.179495
Indiana                  179.510763
Iowa                      54.642103
Kansas                    35.067184
Kentucky                 108.379649
Louisiana                 88.770596
Maine                     37.542063
Maryland                 474.318369
Massachusetts            629.588157
Michigan                 102.081593
Minnesota                 61.875551
Mississippi               61.660197
Missouri                  86.423876
Montana                    6.837955
Nebraska                  23.983945
Nevada                    24.911176
New Hampshire            141.334296
New Jersey              1016.710502
New Mexico                17.135361
New York                 359.359798
North Carolina           181.125657
North Dakota               9.919453
Ohio                     257.719082
Oklahoma                  54.586785
Oregon                    39.637764
Pennsylvania             277.139151
Rhode Island             679.808414
South Carolina           147.574499
South Dakota              10.814785
Tennessee                153.156029
Texas                     97.024196
Utah                      33.624694
Vermont                   65.101716
Virginia                 191.414997
Washington                96.704458
West Virginia             76.624159
Wisconsin                 87.393768
Wyoming                    5.894886
dtype: float64
```



15.排序，并找出2013年人口密度最高的五个州

```python
pp_3 = pp.query('ages=="total" & year=="2013"')
mm = pp_3['population'].div(pp_3['area (sq. mi)'])
mm
```



```
state
Alabama                   92.206131
Alaska                     1.119903
Arizona                   58.125221
Arkansas                  55.646140
California               234.153219
Colorado                  50.608713
Connecticut              648.643579
Delaware                 473.771238
District of Columbia    9506.602941
Florida                  297.345722
Georgia                  168.102269
Hawaii                   128.435236
Idaho                     19.289923
Illinois                 222.420232
Indiana                  180.420154
Iowa                      54.915346
Kansas                    35.171204
Kentucky                 108.764817
Louisiana                 89.220724
Maine                     37.536440
Maryland                 477.860401
Massachusetts            634.090384
Michigan                 102.216940
Minnesota                 62.344065
Mississippi               61.758414
Missouri                  86.705748
Montana                    6.903724
Nebraska                  24.154140
Nevada                    25.234799
New Hampshire            141.531280
New Jersey              1020.332378
New Mexico                17.149729
New York                 360.736613
North Carolina           182.978020
North Dakota              10.231288
Ohio                     258.115642
Oklahoma                  55.084446
Oregon                    39.945368
Pennsylvania             277.341634
Rhode Island             680.589644
South Carolina           149.181085
South Dakota              10.955213
Tennessee                154.130356
Texas                     98.466473
Utah                      34.166494
Vermont                   65.172127
Virginia                 193.140008
Washington                97.771566
West Virginia             76.526103
Wisconsin                 87.670992
Wyoming                    5.956552
dtype: float64
```



```python
mm.sort_values().tail(5)
```



```
state
Massachusetts            634.090384
Connecticut              648.643579
Rhode Island             680.589644
New Jersey              1020.332378
District of Columbia    9506.602941
dtype: float64
```



16.排序，并找出2013年人口密度最低的五个州

```python
mm.sort_values().head(5)
```



```
state
Alaska           1.119903
Wyoming          5.956552
Montana          6.903724
North Dakota    10.231288
South Dakota    10.955213
dtype: float64
```

