<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','/js/analytics.js','ga');

ga('create', 'UA-135687698-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


    
    <title>
        K-近邻算法（KNN） |
        
        欢迎浏览本博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    
    
        <meta name="keywords" content="Ubuntu,Linux,Python,Python Web,爬虫,数据分析,机器学习">
    
    <meta name="description" content="K-近邻算法（KNN）K nearest neighbour 导引">
<meta name="keywords" content="Python,机器学习">
<meta property="og:type" content="article">
<meta property="og:title" content="K-近邻算法（KNN）">
<meta property="og:url" content="https://www.xuhuiblog.cn/机器学习/K-近邻算法-KNN/index.html">
<meta property="og:site_name" content="欢迎浏览本博客">
<meta property="og:description" content="K-近邻算法（KNN）K nearest neighbour 导引">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://www.xuhuiblog.cn/机器学习/K-近邻算法-KNN/1.PNG">
<meta property="og:image" content="https://www.xuhuiblog.cn/机器学习/K-近邻算法-KNN/2.PNG">
<meta property="og:image" content="https://www.xuhuiblog.cn/机器学习/K-近邻算法-KNN/3.PNG">
<meta property="og:image" content="https://www.xuhuiblog.cn/机器学习/K-近邻算法-KNN/4.png">
<meta property="og:image" content="https://www.xuhuiblog.cn/机器学习/K-近邻算法-KNN/output_56_0.png">
<meta property="og:image" content="https://www.xuhuiblog.cn/机器学习/K-近邻算法-KNN/output_61_0.png">
<meta property="og:image" content="https://www.xuhuiblog.cn/机器学习/K-近邻算法-KNN/output_66_0.png">
<meta property="og:image" content="https://www.xuhuiblog.cn/机器学习/K-近邻算法-KNN/output_74_0.png">
<meta property="og:image" content="https://www.xuhuiblog.cn/机器学习/K-近邻算法-KNN/output_76_0.png">
<meta property="og:image" content="https://www.xuhuiblog.cn/机器学习/K-近邻算法-KNN/output_83_0.png">
<meta property="og:image" content="https://www.xuhuiblog.cn/机器学习/K-近邻算法-KNN/stand-sit-run.jpg">
<meta property="og:image" content="https://www.xuhuiblog.cn/机器学习/K-近邻算法-KNN/output_99_0.png">
<meta property="og:image" content="https://www.xuhuiblog.cn/机器学习/K-近邻算法-KNN/output_100_0.png">
<meta property="og:updated_time" content="2019-05-17T13:04:58.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="K-近邻算法（KNN）">
<meta name="twitter:description" content="K-近邻算法（KNN）K nearest neighbour 导引">
<meta name="twitter:image" content="https://www.xuhuiblog.cn/机器学习/K-近邻算法-KNN/1.PNG">
    
        <link rel="alternate" href="/atom.xml" title="欢迎浏览本博客" type="application/atom+xml">
    
    
        <link rel="icon" href="/images/favicon.ico">
    
    
        <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
    
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/highlight.css">
    <script>
        let antiquityStorage = window.sessionStorage.getItem('antiquitySessionStorage');
        if (antiquityStorage == '' || antiquityStorage == null) {
            var antiquityLoader = '<div id="loaderbox"><div class="loader"><div class="load-roll"><div class="load-top"></div><div class="load-right"></div><div class="load-bottom"></div></div></div></div>';
            document.write(antiquityLoader);
            document.body.style.overflow = 'hidden'
        }
    </script>
</head>
</html>
<body>
<div id="fullpage" class="mobile-nav-right">
    
    <div id="wrapper" style="background-image: url(/images/bg.jpg)"
         title="图片来自网络">
        

            <header id="header">
  <div id="nav-toggle" class="nav-toggle"></div>
  <div class="head-box global-width">
    <nav class="nav-box nav-right">
      
        <a class="nav-item" href="/" title>首页</a>
      
        <a class="nav-item" href="https://github.com/pighui" title>基友</a>
      
        <a class="nav-item" href="/archives" title>文章</a>
      
        <a class="nav-item" href="/me" title>简历</a>
      
        <a class="nav-item" href="/snow" title>看雪</a>
      
    </nav>
  </div>
</header>
            <div id="middlecontent" title class="global-width sidebar-right">
                <section id="main"><article id="post-K-近邻算法-KNN" class="article global-container article-type-post" itemscope itemprop="blogPost">
  
    <header class="article-header">
      
  
    <h1 class="article-title" itemprop="name">
      K-近邻算法（KNN）
    </h1>
  

    </header>
  
  <div class="article-meta">
    <a href="/机器学习/K-近邻算法-KNN/" class="article-date">
  <time datetime="2019-05-08T12:10:04.000Z" itemprop="datePublished">2019-05-08</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/机器学习/">机器学习</a>
  </div>

    
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/机器学习/">机器学习</a></li></ul>

  </div>
  
    <span id="busuanzi_container_page_pv">
      本文总阅读量<span id="busuanzi_value_page_pv"></span>次
    </span>
  

  <div class="article-inner">
    
    <div class="article-content article-content-cloud" itemprop="articleBody">
      
        <h1 id="K-近邻算法（KNN）"><a href="#K-近邻算法（KNN）" class="headerlink" title="K-近邻算法（KNN）"></a>K-近邻算法（KNN）</h1><p>K nearest neighbour</p>
<h2 id="导引"><a href="#导引" class="headerlink" title="导引"></a>导引</h2><a id="more"></a>
<h3 id="如何进行电影分类"><a href="#如何进行电影分类" class="headerlink" title="如何进行电影分类"></a>如何进行电影分类</h3><p>众所周知，电影可以按照题材分类，然而题材本身是如何定义的?由谁来判定某部电影属于哪<br>个题材?也就是说同一题材的电影具有哪些公共特征?这些都是在进行电影分类时必须要考虑的问<br>题。没有哪个电影人会说自己制作的电影和以前的某部电影类似，但我们确实知道每部电影在风格<br>上的确有可能会和同题材的电影相近。那么动作片具有哪些共有特征，使得动作片之间非常类似，<br>而与爱情片存在着明显的差别呢？动作片中也会存在接吻镜头，爱情片中也会存在打斗场景，我们<br>不能单纯依靠是否存在打斗或者亲吻来判断影片的类型。但是爱情片中的亲吻镜头更多，动作片中<br>的打斗场景也更频繁，基于此类场景在某部电影中出现的次数可以用来进行电影分类。</p>
<p>本章介绍第一个机器学习算法：K-近邻算法，它非常有效而且易于掌握。</p>
<h2 id="1、k-近邻算法原理"><a href="#1、k-近邻算法原理" class="headerlink" title="1、k-近邻算法原理"></a>1、k-近邻算法原理</h2><p>简单地说，K-近邻算法采用测量不同特征值之间的距离方法进行分类。</p>
<ul>
<li>优点：精度高、对异常值不敏感、无数据输入假定。</li>
<li>缺点：时间复杂度高、空间复杂度高。</li>
<li>适用数据范围：数值型和标称型。</li>
</ul>
<h3 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h3><p>存在一个样本数据集合，也称作训练样本集，并且样本集中每个数据都存在标签，即我们知道样本集中每一数据<br>与所属分类的对应关系。输人没有标签的新数据后，将新数据的每个特征与样本集中数据对应的<br>特征进行比较，然后算法提取样本集中特征最相似数据（最近邻）的分类标签。一般来说，我们<br>只选择样本数据集中前K个最相似的数据，这就是K-近邻算法中K的出处,通常<em>K是不大于20的整数。<br>最后 ，选择K个最相似数据中出现次数最多的分类，作为新数据的分类</em>。</p>
<p>回到前面电影分类的例子，使用K-近邻算法分类爱情片和动作片。有人曾经统计过很多电影的打斗镜头和接吻镜头，下图显示了6部电影的打斗和接吻次数。假如有一部未看过的电影，如何确定它是爱情片还是动作片呢？我们可以使用K-近邻算法来解决这个问题。</p>
<p><img src="/机器学习/K-近邻算法-KNN/1.PNG" alt="1.PNG"></p>
<p>首先我们需要知道这个未知电影存在多少个打斗镜头和接吻镜头，上图中问号位置是该未知电影出现的镜头数图形化展示，具体数字参见下表。</p>
<p><img src="/机器学习/K-近邻算法-KNN/2.PNG" alt="2.PNG"></p>
<p>即使不知道未知电影属于哪种类型，我们也可以通过某种方法计算出来。首先计算未知电影与样本集中其他电影的距离，如图所示。</p>
<p><img src="/机器学习/K-近邻算法-KNN/3.PNG" alt="3.PNG"></p>
<p>现在我们得到了样本集中所有电影与未知电影的距离，按照距离递增排序，可以找到K个距<br>离最近的电影。假定k=3，则三个最靠近的电影依次是California Man、He’s Not Really into Dudes、Beautiful Woman。K-近邻算法按照距离最近的三部电影的类型，决定未知电影的类型，而这三部电影全是爱情片，因此我们判定未知电影是爱情片。</p>
<h3 id="欧几里得距离-Euclidean-Distance"><a href="#欧几里得距离-Euclidean-Distance" class="headerlink" title="欧几里得距离(Euclidean Distance)"></a>欧几里得距离(Euclidean Distance)</h3><p>欧氏距离是最常见的距离度量，衡量的是多维空间中各个点之间的绝对距离。公式如下：</p>
<p><img src="/机器学习/K-近邻算法-KNN/4.png" alt="4.png"></p>
<h2 id="2、在scikit-learn库中使用k-近邻算法"><a href="#2、在scikit-learn库中使用k-近邻算法" class="headerlink" title="2、在scikit-learn库中使用k-近邻算法"></a>2、在scikit-learn库中使用k-近邻算法</h2><ul>
<li>分类问题：from sklearn.neighbors import KNeighborsClassifier</li>
<li>回归问题：from sklearn.neighbors import KNeighborsRegressor</li>
</ul>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series,DataFrame</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">%matplotlib inline</span><br></pre></td></tr></table></figure></div>
<h3 id="0）一个最简单的例子"><a href="#0）一个最简单的例子" class="headerlink" title="0）一个最简单的例子"></a>0）一个最简单的例子</h3><p>身高、体重、鞋子尺码数据对应性别</p>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 身高、体重、鞋的尺寸</span></span><br><span class="line">X = np.array([[<span class="number">181</span>,<span class="number">80</span>,<span class="number">44</span>],</span><br><span class="line">              [<span class="number">177</span>,<span class="number">70</span>,<span class="number">43</span>],</span><br><span class="line">              [<span class="number">160</span>,<span class="number">60</span>,<span class="number">38</span>],</span><br><span class="line">              [<span class="number">154</span>,<span class="number">54</span>,<span class="number">37</span>],</span><br><span class="line">              [<span class="number">166</span>,<span class="number">65</span>,<span class="number">40</span>],</span><br><span class="line">              [<span class="number">190</span>,<span class="number">90</span>,<span class="number">47</span>],</span><br><span class="line">              [<span class="number">175</span>,<span class="number">64</span>,<span class="number">39</span>],</span><br><span class="line">              [<span class="number">177</span>,<span class="number">70</span>,<span class="number">40</span>],</span><br><span class="line">              [<span class="number">159</span>,<span class="number">55</span>,<span class="number">37</span>],</span><br><span class="line">              [<span class="number">171</span>,<span class="number">75</span>,<span class="number">42</span>],</span><br><span class="line">              [<span class="number">181</span>,<span class="number">85</span>,<span class="number">43</span>],</span><br><span class="line">              [<span class="number">175</span>,<span class="number">64</span>,<span class="number">42</span>],</span><br><span class="line">              [<span class="number">162</span>,<span class="number">50</span>,<span class="number">37</span>],</span><br><span class="line">              [<span class="number">176</span>,<span class="number">80</span>,<span class="number">42</span>]])</span><br><span class="line"></span><br><span class="line">y = [<span class="string">'male'</span>,</span><br><span class="line">     <span class="string">'male'</span>,</span><br><span class="line">     <span class="string">'female'</span>,</span><br><span class="line">     <span class="string">'female'</span>,</span><br><span class="line">     <span class="string">'male'</span>,</span><br><span class="line">     <span class="string">'male'</span>,</span><br><span class="line">     <span class="string">'female'</span>,</span><br><span class="line">     <span class="string">'female'</span>,</span><br><span class="line">     <span class="string">'female'</span>,</span><br><span class="line">     <span class="string">'male'</span>,</span><br><span class="line">     <span class="string">'male'</span>,</span><br><span class="line">     <span class="string">'male'</span>,</span><br><span class="line">     <span class="string">'female'</span>,</span><br><span class="line">     <span class="string">'male'</span>]</span><br></pre></td></tr></table></figure></div>
<p>构建KNN分类器对象</p>
<p>knnclf = KNeighborsClassifier(n_neighbors=3)</p>
<p>n_neighbors应设置为一个奇数，表示距离预测样本最近的n个样本点</p>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">knn = KNeighborsClassifier(n_neighbors=<span class="number">3</span>) <span class="comment"># 指定邻居的数量, 必须是奇数</span></span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">knn.fit(X, y) <span class="comment"># 训练模型</span></span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">KNeighborsClassifier(algorithm=&apos;auto&apos;, leaf_size=30, metric=&apos;minkowski&apos;,</span><br><span class="line">           metric_params=None, n_jobs=1, n_neighbors=3, p=2,</span><br><span class="line">           weights=&apos;uniform&apos;)</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 训练数据集的特征数和预测数据集的特征数必须保持一致</span></span><br><span class="line">test_X = [</span><br><span class="line">    [<span class="number">186</span>, <span class="number">110</span>, <span class="number">45</span>],</span><br><span class="line">    [<span class="number">170</span>, <span class="number">75</span>,  <span class="number">42</span>],</span><br><span class="line">    [<span class="number">182</span>, <span class="number">80</span>,  <span class="number">42</span>],</span><br><span class="line">    [<span class="number">165</span>, <span class="number">50</span>,  <span class="number">37</span>],</span><br><span class="line">    [<span class="number">170</span>, <span class="number">55</span>,  <span class="number">38</span>]</span><br><span class="line">]</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">knn.predict(test_X)</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array([&apos;male&apos;, &apos;male&apos;, &apos;male&apos;, &apos;female&apos;, &apos;female&apos;], dtype=&apos;&lt;U6&apos;)</span><br></pre></td></tr></table></figure></div>
<h3 id="2）电影分类：-动作片、爱情片"><a href="#2）电影分类：-动作片、爱情片" class="headerlink" title="2）电影分类： 动作片、爱情片"></a>2）电影分类： 动作片、爱情片</h3><div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data = &#123;</span><br><span class="line">    <span class="string">'动作次数'</span>: [ <span class="number">18</span>, <span class="number">20</span>, <span class="number">3</span>,  <span class="number">5</span>, <span class="number">16</span>, <span class="number">22</span>],</span><br><span class="line">    <span class="string">'接吻次数'</span>: [ <span class="number">2</span>,  <span class="number">1</span>,  <span class="number">18</span>, <span class="number">12</span>, <span class="number">2</span>,  <span class="number">1</span>],</span><br><span class="line">    <span class="string">'电影类型'</span>: [<span class="string">'动作片'</span>, <span class="string">'动作片'</span>, <span class="string">'爱情片'</span>, <span class="string">'爱情片'</span>, <span class="string">'动作片'</span>, <span class="string">'动作片'</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>创建DataFrame</p>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">movies = DataFrame(data)</span><br><span class="line">movies</span><br></pre></td></tr></table></figure></div>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br>    .dataframe tbody tr th {<br>    vertical-align: top;<br>}<br>.dataframe thead th {<br>    text-align: right;<br>}<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>动作次数</th><br>      <th>接吻次数</th><br>      <th>电影类型</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>0</th><br>      <td>18</td><br>      <td>2</td><br>      <td>动作片</td><br>    </tr><br>    <tr><br>      <th>1</th><br>      <td>20</td><br>      <td>1</td><br>      <td>动作片</td><br>    </tr><br>    <tr><br>      <th>2</th><br>      <td>3</td><br>      <td>18</td><br>      <td>爱情片</td><br>    </tr><br>    <tr><br>      <th>3</th><br>      <td>5</td><br>      <td>12</td><br>      <td>爱情片</td><br>    </tr><br>    <tr><br>      <th>4</th><br>      <td>16</td><br>      <td>2</td><br>      <td>动作片</td><br>    </tr><br>    <tr><br>      <th>5</th><br>      <td>22</td><br>      <td>1</td><br>      <td>动作片</td><br>    </tr><br>  </tbody><br></table><br></div>




<p>提取训练数据的样式</p>
<p>创建和训练KNN分类模型</p>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">knn_movie = KNeighborsClassifier(n_neighbors=<span class="number">3</span>)</span><br><span class="line">knn_movie.fit(movies.iloc[:, :<span class="number">2</span>].values,</span><br><span class="line">              movies.iloc[:, <span class="number">-1</span>])</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">KNeighborsClassifier(algorithm=&apos;auto&apos;, leaf_size=30, metric=&apos;minkowski&apos;,</span><br><span class="line">           metric_params=None, n_jobs=1, n_neighbors=3, p=2,</span><br><span class="line">           weights=&apos;uniform&apos;)</span><br></pre></td></tr></table></figure></div>
<p>预测数据</p>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">knn_movie.predict([[<span class="number">20</span>,<span class="number">1</span>], [<span class="number">5</span>, <span class="number">12</span>], [<span class="number">10</span>, <span class="number">10</span>]])</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array([&apos;动作片&apos;, &apos;爱情片&apos;, &apos;爱情片&apos;], dtype=object)</span><br></pre></td></tr></table></figure></div>
<h3 id="3）-数据鸢尾花-分类"><a href="#3）-数据鸢尾花-分类" class="headerlink" title="3） 数据鸢尾花 分类"></a>3） 数据鸢尾花 分类</h3><p>导包，机器学习的算法KNN、数据鸢尾花</p>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_iris</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iris = load_iris()  <span class="comment"># 返回一个字典对象</span></span><br><span class="line">iris.keys()</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dict_keys([&apos;data&apos;, &apos;target&apos;, &apos;target_names&apos;, &apos;DESCR&apos;, &apos;feature_names&apos;])</span><br></pre></td></tr></table></figure></div>
<p>获取训练样本</p>
<p>sklearn.datasets.load_iris是机器学习库提供给我们研究算法的数据方法， 返回的对象的属性有：</p>
<ul>
<li>data 数据</li>
<li>target 目标</li>
<li>target_names 目标名</li>
<li>feature_names 特征名</li>
</ul>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iris.target_names</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array([&apos;setosa&apos;, &apos;versicolor&apos;, &apos;virginica&apos;], dtype=&apos;&lt;U10&apos;)</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iris_df = DataFrame(iris.data, columns=iris.feature_names)</span><br><span class="line">iris_df[<span class="string">'target'</span>] = Series(iris.target)</span><br><span class="line">iris_df.head()</span><br></pre></td></tr></table></figure></div>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br>    .dataframe tbody tr th {<br>    vertical-align: top;<br>}<br>.dataframe thead th {<br>    text-align: right;<br>}<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>sepal length (cm)</th><br>      <th>sepal width (cm)</th><br>      <th>petal length (cm)</th><br>      <th>petal width (cm)</th><br>      <th>target</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>0</th><br>      <td>5.1</td><br>      <td>3.5</td><br>      <td>1.4</td><br>      <td>0.2</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>1</th><br>      <td>4.9</td><br>      <td>3.0</td><br>      <td>1.4</td><br>      <td>0.2</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>2</th><br>      <td>4.7</td><br>      <td>3.2</td><br>      <td>1.3</td><br>      <td>0.2</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>3</th><br>      <td>4.6</td><br>      <td>3.1</td><br>      <td>1.5</td><br>      <td>0.2</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>4</th><br>      <td>5.0</td><br>      <td>3.6</td><br>      <td>1.4</td><br>      <td>0.2</td><br>      <td>0</td><br>    </tr><br>  </tbody><br></table><br></div>




<p>通过标准差，选择合适的特征数据集</p>
<p>df.std(axis=0)</p>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iris_df.std(axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sepal length (cm)    0.828066</span><br><span class="line">sepal width (cm)     0.433594</span><br><span class="line">petal length (cm)    1.764420</span><br><span class="line">petal width (cm)     0.763161</span><br><span class="line">target               0.819232</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure></div>
<p>查看分类的数量 （种类）</p>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iris_df[<span class="string">'target'</span>].unique()</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array([0, 1, 2])</span><br></pre></td></tr></table></figure></div>
<p>查看特征名 feature_names</p>
<p>选择前80%的行数据作为训练集, 后20%的数据作为测试集 </p>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">samples = iris.data[:, :<span class="number">2</span>] <span class="comment"># 前两列数据</span></span><br><span class="line">samples.shape</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(150, 2)</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 随机拆分的样本数据和目标数据， 默认测试数据集的大小是25%，test_size=0.25</span></span><br><span class="line">train_x, test_x, train_y, test_y = train_test_split(samples, iris.target,test_size=<span class="number">0.2</span>)</span><br></pre></td></tr></table></figure></div>
<p>注意：（离散性的、标称型的）目标值是不参与运算的，所以不是必须要转换成数字的格式</p>
<p>绘制图形</p>
<ul>
<li>plt.scatter()</li>
<li>matplotlib.colors.ListedColormap([]) 颜色映射列表</li>
</ul>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> matplotlib.colors <span class="keyword">import</span> ListedColormap</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cm = ListedColormap([<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>])</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">plt.scatter(samples[:, <span class="number">0</span>], samples[:, <span class="number">1</span>], c=iris.target, cmap=cm)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure></div>
<p><img src="/机器学习/K-近邻算法-KNN/output_56_0.png" alt="png"></p>
<p>对样本数据进行训练</p>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">knn_iris = KNeighborsClassifier(n_neighbors=<span class="number">3</span>)</span><br><span class="line">knn_iris.fit(train_x, train_y)</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">KNeighborsClassifier(algorithm=&apos;auto&apos;, leaf_size=30, metric=&apos;minkowski&apos;,</span><br><span class="line">           metric_params=None, n_jobs=1, n_neighbors=3, p=2,</span><br><span class="line">           weights=&apos;uniform&apos;)</span><br></pre></td></tr></table></figure></div>
<p>对数据进行预测</p>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y_ = knn_iris.predict(test_x)</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plt.scatter(test_x[:, <span class="number">0</span>], test_x[:, <span class="number">1</span>], c=test_y)</span><br><span class="line">plt.scatter(test_x[:, <span class="number">0</span>], test_x[:, <span class="number">1</span>], c=y_, cmap=cm)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure></div>
<p><img src="/机器学习/K-近邻算法-KNN/output_61_0.png" alt="png"></p>
<p>生成满屏预测数据</p>
<ul>
<li>min, max</li>
<li>np.linspace(min, max, size=1000)</li>
<li>np.meshgrid(x, y) 表格的格点处理<ul>
<li>x确定列数</li>
<li>y确定行数</li>
</ul>
</li>
<li>xx.ravel() 扁平化</li>
<li>np.c_[xx, yy]  组合两个数组</li>
</ul>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">f1 = np.linspace(samples[:, <span class="number">0</span>].min(), samples[:, <span class="number">0</span>].max(), num=<span class="number">200</span>)</span><br><span class="line">f2 = np.linspace(samples[:, <span class="number">1</span>].min(), samples[:, <span class="number">1</span>].max(), num=<span class="number">200</span>)</span><br><span class="line"></span><br><span class="line">f1, f2 = np.meshgrid(f1, f2)</span><br><span class="line">test_x = np.c_[f1.ravel(), f2.ravel()]</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">knn_iris.fit(samples, iris.target)</span><br><span class="line">y_=knn_iris.predict(test_x)</span><br></pre></td></tr></table></figure></div>
<p>绘制满屏的scatter图</p>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plt.scatter(test_x[:, <span class="number">0</span>], test_x[:, <span class="number">1</span>], c=y_, cmap=cm)</span><br><span class="line">plt.scatter(samples[:, <span class="number">0</span>], samples[:, <span class="number">1</span>], c=iris.target)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure></div>
<p><img src="/机器学习/K-近邻算法-KNN/output_66_0.png" alt="png"></p>
<p>matplotlib.colors.ListedColormap 多颜色映射列表</p>
<p>cmap = ListedColormap([‘#aa00ff’,’#00aaff’,’#ffaa00’])</p>
<ul>
<li>展示预测数据的分类情况</li>
</ul>
<p>plt.scatter(X_test[:,0],X_test[:,1],c=y_,cmap=cmap)</p>
<ul>
<li>展示真实数据的分类情况</li>
</ul>
<p>plt.scatter(samples.iloc[:,0],samples.iloc[:,1],c=target)</p>
<h4 id="4）用于回归"><a href="#4）用于回归" class="headerlink" title="4）用于回归"></a>4）用于回归</h4><p>回归用于对趋势的预测</p>
<p>导包</p>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsRegressor</span><br></pre></td></tr></table></figure></div>
<p>生成样本数据</p>
<ul>
<li>符合正弦分布的数据 </li>
<li>生成噪音数据 <ul>
<li>noise = np.random.random(size=20) - 0.5</li>
<li>y[::2] += noise</li>
</ul>
</li>
</ul>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x = np.linspace(<span class="number">0</span>, <span class="number">2</span>*np.pi, num=<span class="number">50</span>)</span><br><span class="line">y = np.sin(x)</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">plt.scatter(x, y)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure></div>
<p><img src="/机器学习/K-近邻算法-KNN/output_74_0.png" alt="png"></p>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">noise = np.random.random(size=<span class="number">25</span>) - <span class="number">0.5</span></span><br><span class="line">y[::<span class="number">2</span>] += noise</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">plt.scatter(x, y)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure></div>
<p><img src="/机器学习/K-近邻算法-KNN/output_76_0.png" alt="png"></p>
<p>第一步：生成模型，并训练数据</p>
<ul>
<li>可能会出现过拟合和欠拟合情况</li>
</ul>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">knn_regressor = KNeighborsRegressor(n_neighbors=<span class="number">5</span>)</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">knn_regressor.fit(x.reshape(<span class="number">-1</span>, <span class="number">1</span>), y)</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">KNeighborsRegressor(algorithm=&apos;auto&apos;, leaf_size=30, metric=&apos;minkowski&apos;,</span><br><span class="line">          metric_params=None, n_jobs=1, n_neighbors=5, p=2,</span><br><span class="line">          weights=&apos;uniform&apos;)</span><br></pre></td></tr></table></figure></div>
<p>第二步：使用模型，预测数据</p>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">test_x = np.linspace(<span class="number">0</span>, <span class="number">2</span>*np.pi, num=<span class="number">200</span>)</span><br><span class="line">y_ = knn_regressor.predict(test_x.reshape(<span class="number">-1</span>, <span class="number">1</span>))</span><br></pre></td></tr></table></figure></div>
<p>绘图显示数据</p>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plt.scatter(x, y, c=<span class="string">'r'</span>)</span><br><span class="line">plt.plot(test_x, y_, c=<span class="string">'b'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure></div>
<p><img src="/机器学习/K-近邻算法-KNN/output_83_0.png" alt="png"></p>
<h3 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h3><p>人类动作识别<br>步行，上楼，下楼，坐着，站立和躺着<br><img src="/机器学习/K-近邻算法-KNN/stand-sit-run.jpg" alt><br>数据采集每个人在腰部穿着智能手机，进行了六个活动（步行，上楼，下楼，坐着，站立和躺着）。采用嵌入式加速度计和陀螺仪，以50Hz的恒定速度捕获3轴线性加速度和3轴角速度，来获取数据</p>
<p>导入数据</p>
<ul>
<li>np.load(‘xx.npy’)</li>
<li>x_train.npy 训练数据 X</li>
<li>y_train.npy 训练数据目标</li>
<li>x_test.npy  预测数据 </li>
<li>y_test.npy</li>
</ul>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">train_X = np.load(<span class="string">'npy/x_train.npy'</span>)</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">train_X.shape</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(7352, 561)</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">train_y = np.load(<span class="string">'npy/y_train.npy'</span>)  <span class="comment"># np.save(filepath, arr)</span></span><br><span class="line">test_X = np.load(<span class="string">'npy/x_test.npy'</span>)</span><br><span class="line">test_y = np.load(<span class="string">'npy/y_test.npy'</span>)</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不同动作</span></span><br><span class="line">label = &#123;<span class="number">1</span>:<span class="string">'WALKING'</span>, </span><br><span class="line">         <span class="number">2</span>:<span class="string">'WALKING UPSTAIRS'</span>, </span><br><span class="line">         <span class="number">3</span>:<span class="string">'WALKING DOWNSTAIRS'</span>,</span><br><span class="line">         <span class="number">4</span>:<span class="string">'SITTING'</span>, </span><br><span class="line">         <span class="number">5</span>:<span class="string">'STANDING'</span>, </span><br><span class="line">         <span class="number">6</span>:<span class="string">'LAYING'</span>&#125;</span><br></pre></td></tr></table></figure></div>
<p>训练、预测</p>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">3</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    walk_knn = KNeighborsClassifier(n_neighbors=n)</span><br><span class="line">    walk_knn.fit(train_X, train_y)  <span class="comment"># 训练</span></span><br><span class="line">    y_ = walk_knn.predict(test_X)   <span class="comment"># 预测</span></span><br><span class="line">    score = test_y[test_y==y_].size/test_y.size</span><br><span class="line">    <span class="keyword">if</span> score &gt;=<span class="number">0.95</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    n += <span class="number">2</span></span><br><span class="line">print(<span class="string">'本次得分:'</span>, score, <span class="string">'n='</span>, n)</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">9</span></span><br><span class="line"></span><br><span class="line">walk_knn = KNeighborsClassifier(n_neighbors=n)</span><br><span class="line">walk_knn.fit(train_X, train_y)  <span class="comment"># 训练</span></span><br><span class="line">y_ = walk_knn.predict(test_X)   <span class="comment"># 预测</span></span><br><span class="line">score = test_y[test_y==y_].size/test_y.size</span><br><span class="line">print(<span class="string">'本次得分:'</span>, score, <span class="string">'n='</span>, n)</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">本次得分: 0.9053274516457415 n= 9</span><br></pre></td></tr></table></figure></div>
<p>查看得分</p>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">walk_knn.score(test_X, test_y)</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0.9046487953851374</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test_y[test_y==y_].size/test_y.size</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0.9046487953851374</span><br></pre></td></tr></table></figure></div>
<p>画出不同动作的线性图</p>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Series(train_y).unique()  <span class="comment"># 目标， 六个动作</span></span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array([5, 4, 6, 1, 3, 2])</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查出走的动作的数据</span></span><br><span class="line">x = train_X[train_y==<span class="number">1</span>][:<span class="number">500</span>, <span class="number">0</span>]</span><br></pre></td></tr></table></figure></div>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">plt.plot(x, color=<span class="string">'#c40488'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure></div>
<p><img src="/机器学习/K-近邻算法-KNN/output_99_0.png" alt="png"></p>
<div class="highlight-box" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 画六个子画布</span></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">12</span>))</span><br><span class="line">index = <span class="number">1</span></span><br><span class="line">colors = (<span class="string">'#c40488'</span>, <span class="string">'#cd2408'</span>, <span class="string">'#f404d8'</span>, <span class="string">'#34d488'</span>, <span class="string">'#84f4c8'</span>, <span class="string">'#04d500'</span>)</span><br><span class="line"><span class="keyword">for</span> k, name <span class="keyword">in</span> label.items():</span><br><span class="line">    x = train_X[train_y==k][:<span class="number">500</span>, <span class="number">0</span>]</span><br><span class="line">    ax = plt.subplot(<span class="number">3</span>,<span class="number">2</span>, index)</span><br><span class="line">    ax.set_title(name)</span><br><span class="line">    ax.plot(x, c=colors[index<span class="number">-1</span>])</span><br><span class="line">    index += <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure></div>
<p><img src="/机器学习/K-近邻算法-KNN/output_100_0.png" alt="png"></p>

      
    </div>
    
      <footer class="article-footer">
        完
      </footer>
    
  </div>
  
    
<nav id="article-nav">
  <div class="article-nav-block">
    
      <a href="/机器学习/KNN-手写数字识别/" id="article-nav-newer" class="article-nav-link-wrap">
        <strong class="article-nav-caption"></strong>
        <div class="article-nav-title">
          
            KNN-手写数字识别
          
        </div>
      </a>
    
  </div>
  <div class="article-nav-block">
    
      <a href="/数据分析/海洋数据分析/" id="article-nav-older" class="article-nav-link-wrap">
        <div class="article-nav-title">海洋数据分析</div>
        <strong class="article-nav-caption"></strong>
      </a>
    
  </div>
</nav>

    
<div id="gitmentContainer"></div>
<link rel="stylesheet" href="https://www.xuhuiblog.cn/css/gitment.css">
<script type="text/javascript" src="https://www.xuhuiblog.cn/js/gitment.js"></script>
<script type="text/javascript" src="https://www.xuhuiblog.cn/js/md5.min.js"></script>
<script>
var gitment = new Gitment({
  id: md5(window.location.pathname.replace(/index.html/, "")),
  owner: 'pighui',
  repo: 'myblogdes',
  oauth: {
    client_id: '79535b24d59031961e6c',
    client_secret: '4f1907f09f33c1182feb2ddfeef33677e8e5ff36',
  },
})
gitment.render('gitmentContainer')
</script>

  
  
</article>
</section>
                <aside id="sidebar">
    <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="360" height="86" src="//music.163.com/outchain/player?type=2&id=1346998796&auto=0&height=66"></iframe>
    
        <div class="widget-box">
    <div class="avatar-box">
        <img class="avatar" src="/images/default-avatar.jpeg" title="图片来自网络">
        <h3 class="avatar-name">
            
                一介书生
            
        </h3>
        <p class="avatar-slogan">
            盼 君 金 榜 题 名 时 。
寒 窗 苦 读 数 十 载 ，
        </p>
    </div>
</div>


    
        
  <div class="widget-box">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/">Hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kali/">Kali</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Ubuntu/">Ubuntu</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据分析/">数据分析</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/机器学习/">机器学习</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/爬虫/">爬虫</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/面试题/">面试题</a></li></ul>
    </div>
  </div>


    
        
  <div class="widget-box">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/">Docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kali/">Kali</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ubuntu/">Ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据分析/">数据分析</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/机器学习/">机器学习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/测试/">测试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/爬虫/">爬虫</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/面试题/">面试题</a></li></ul>
    </div>
  </div>


    
        
  <div class="widget-box">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Docker/" style="font-size: 11.43px;">Docker</a> <a href="/tags/Hexo/" style="font-size: 12.86px;">Hexo</a> <a href="/tags/Kali/" style="font-size: 10px;">Kali</a> <a href="/tags/Python/" style="font-size: 20px;">Python</a> <a href="/tags/Ubuntu/" style="font-size: 15.71px;">Ubuntu</a> <a href="/tags/数据分析/" style="font-size: 18.57px;">数据分析</a> <a href="/tags/机器学习/" style="font-size: 14.29px;">机器学习</a> <a href="/tags/测试/" style="font-size: 11.43px;">测试</a> <a href="/tags/爬虫/" style="font-size: 17.14px;">爬虫</a> <a href="/tags/面试题/" style="font-size: 10px;">面试题</a>
    </div>
  </div>

    
        
  <div class="widget-box">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li></ul>
    </div>
  </div>

    
        
  <div class="widget-box">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/机器学习/人脸自动补全/">人脸自动补全</a>
          </li>
        
          <li>
            <a href="/机器学习/Logistics回归和数字识别/">Logistics回归和数字识别</a>
          </li>
        
          <li>
            <a href="/机器学习/LinearRegression线性回归/">LinearRegression线性回归</a>
          </li>
        
          <li>
            <a href="/机器学习/KNN-手写数字识别/">KNN-手写数字识别</a>
          </li>
        
          <li>
            <a href="/机器学习/K-近邻算法-KNN/">K-近邻算法（KNN）</a>
          </li>
        
      </ul>
    </div>
  </div>

    
          <div class="widget-box">
    <h3 class="widget-title">友链</h3>
    <div class="widget">
      
        <a style="display: block;" href="https://yiluyanxia.github.io/" title target="_blank">一路眼瞎</a>
      
        <a style="display: block;" href="https://wljsky.cn/" title target="_blank">钧金</a>
      
    </div>
  </div>

    
</aside>
            </div>
            <footer id="footer">
    <!-- 百度推送 -->
    <script>
        (function () {
            var bp = document.createElement('script');
            var curProtocol = window.location.protocol.split(':')[0];
            if (curProtocol === 'https') {
                bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
            } else {
                bp.src = 'http://push.zhanzhang.baidu.com/push.js';
            }
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(bp, s);
        })();
    </script>

    <!-- 百度统计 -->
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?58e88d550a3485e4fa9494eb391c7e47";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <!-- <script async src="https://www.googletagmanager.com/gtag/js?id=UA-135687698-1"></script> -->
    <script src="/js/google.js"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());
        gtag('set', {'user_id': 'UA-135687698-1'});
        gtag('config', 'UA-135687698-1');
    </script>
    <div class="foot-box global-width">
        &copy;Copyright&nbsp;2019 一介书生<br>
        驱动于 <a href="http://hexo.io/" target="_blank">Hexo</a>
        &nbsp;|&nbsp;主题 <a href="https://github.com/yiluyanxia/hexo-theme-antiquity">antiquity</a>
        <br>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <span id="busuanzi_container_site_pv">阁下是第<span id="busuanzi_value_site_pv"></span>个访客</span>
        <br>
        豫ICP备<a href="http://ha.beian.miit.gov.cn/">19008962</a>号
    </div>
</footer>
            <script src="//libs.baidu.com/jquery/2.1.4/jquery.min.js"></script>
<script>
    if (!window.jQuery) {
        var script = document.createElement('script');
        script.src = "/js/jquery.min.js";
        document.body.write(script);
    }
</script>

    <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
    <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



        </div>
        <nav id="mobile-nav" class="mobile-nav-box">
  <div class="mobile-nav-img mobile-nav-top"></div>
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="https://github.com/pighui" class="mobile-nav-link">基友</a>
  
    <a href="/archives" class="mobile-nav-link">文章</a>
  
    <a href="/me" class="mobile-nav-link">简历</a>
  
    <a href="/snow" class="mobile-nav-link">看雪</a>
  
  <div class="mobile-nav-img  mobile-nav-bottom"></div>
</nav>
    </div>
    <script type="text/javascript" src="/js/jquery.min.js"></script>
    <script src="/js/love.js"></script>
    <script src="/js/snowy.js"></script>
    <style type="text/css">.snow-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 100001;
        }</style>
    <div class="snow-container"></div>
</body>
</html>